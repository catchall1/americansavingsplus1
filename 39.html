<body>
  <div id="ip-info">
    Your IP address: 
    <span id="ip"></span>
  </div>
  <div id="location-info">
    Your location: 
    <span id="location"></span>
  </div>
  <script>
    function getIP() {
      fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
        const ipElement = document.getElementById('ip');
        ipElement.textContent = data.ip;
        getLocation(data.ip);
      }
             );
    }
    function getLocation(ip) {
      fetch('http://api.ipstack.com/' + ip + '?access_key=' + process.env.IPSTACK_API_KEY)
        .then(response => response.json())
        .then(data => {
        if(data.success){
          const location = data.city + ', ' + data.region_name;
          const locationElement = document.getElementById('location');
          locationElement.textContent = location;
        }
        else {
          console.error(data.error.info);
        }
      }
             )
        .catch(error => {
        console.error(error);
      }
              );
    }
    window.onload = function() {
      getIP();
    }
  </script>
</body>
